function synchronize(a){_config.queue[_config.queue.length]=a,_config.blocking||process()}function process(){while(_config.queue.length&&!_config.blocking){var a=_config.queue[0];_config.queue=_config.queue.slice(1),a()}}function stop(a){_config.blocking=!0;var b=a?start:function(){ok(!1,"Test timed out"),start()};_config.timeout=setTimeout(b,_config.asyncTimeout*1e3)}function start(){_config.timeout&&clearTimeout(_config.timeout),_config.blocking=!1,process()}function runTest(a){_config.blocking=!1;var b=new Date;_config.fixture=document.getElementById("main").innerHTML,synchronize(function(){b=new Date-b,window.parent.totalTime+=b,window.parent.failedTests+=_config.stats.bad,window.parent.totalTests+=_config.stats.all,a&&a()})}function test(a,b,c){$.browser.safari&&!c&&test("",function(){stop(),setTimeout(start,250)},!0),_config.currentModule&&(a=_config.currentModule+" module: "+a),synchronize(function(){_config.Test=[];try{b()}catch(c){typeof console!="undefined"&&console.error&&console.warn&&(console.error("Test "+a+" died, exception and test follows"),console.error(c),console.warn(b.toString())),_config.Test.push([!1,"Died on test #"+(_config.Test.length+1)+": "+c])}}),synchronize(function(){reset();if(c)return;_config.expected&&_config.expected!=_config.Test.length&&_config.Test.push([!1,"Expected "+_config.expected+" assertions, but "+_config.Test.length+" were run"]),_config.expected=null;var b=0,d=0,e=document.createElement("ol");e.style.display="none";var f="",g="pass";for(var h=0;h<_config.Test.length;h++){var f=document.createElement("li");f.className=_config.Test[h][0]?"pass":"fail",f.innerHTML=_config.Test[h][1],e.appendChild(f),_config.stats.all++,_config.Test[h][0]?b++:(g="fail",d++,_config.stats.bad++)}var f=document.createElement("li");f.className=g;var i=document.createElement("b");i.innerHTML=a+" <b style='color:black;'>(<b class='fail'>"+d+"</b>, <b class='pass'>"+b+"</b>, "+_config.Test.length+")</b>",i.onclick=function(){var a=this.nextSibling;jQuery.css(a,"display")=="none"?a.style.display="block":a.style.display="none"},f.appendChild(i),f.appendChild(e),document.getElementById("tests").appendChild(f)})}function module(a){_config.currentModule=a}function expect(a){_config.expected=a}function reset(){document.getElementById("main").innerHTML=_config.fixture}function ok(a,b){_config.Test.push([!!a,b])}function isSet(a,b,c){var d=!0;if(a&&b&&a.length==b.length)for(var e=0;e<a.length;e++)a[e]!=b[e]&&(d=!1);else d=!1;d?_config.Test.push([d,c]):_config.Test.push([d,c+" expected: "+serialArray(b)+" result: "+serialArray(a)])}function serialArray(a){var b=[];for(var c=0;c<a.length;c++){var d=a[c].nodeName;d?(d=d.toLowerCase(),a[c].id&&(d+="#"+a[c].id)):d=a[c],b.push(d)}return"[ "+b.join(", ")+" ]"}function q(){var a=[];for(var b=0;b<arguments.length;b++)a.push(document.getElementById(arguments[b]));return a}function t(a,b,c){var d=jQuery(b),e="";for(var f=0;f<d.length;f++)e+=(e&&",")+'"'+d[f].id+'"';isSet(d,q.apply(q,c),a+" ("+b+")")}function url(a){return a+(/\?/.test(a)?"&":"?")+(new Date).getTime()+""+parseInt(Math.random()*1e5)}function equals(a,b,c){var d=a==b;c=c||(d?"okay":"failed"),_config.Test.push([d,d?c+": "+a:c+" expected: "+a+" actual: "+b])}function triggerEvent(a,b,c){jQuery.browser.mozilla||jQuery.browser.opera?(c=document.createEvent("MouseEvents"),c.initMouseEvent(b,!0,!0,a.ownerDocument.defaultView,0,0,0,0,0,!1,!1,!1,!1,0,null),a.dispatchEvent(c)):jQuery.browser.msie&&a.fireEvent("on"+b)}var _config={fixture:null,Test:[],stats:{all:0,bad:0},queue:[],blocking:!0,timeout:null,expected:null,currentModule:null,asyncTimeout:2}